'use client';

import React, { useEffect, useState } from 'react';
import { useFortniteGame } from '@/hooks/useFortniteGame';
import { Card, League, GameView } from '@/types/fortnite-game';
import { Button } from '@/components/ui/button';
import { Card as CardComponent, CardContent, CardHeader, CardTitle } from '@/components/ui/card';

// Importar CARDS para usar como fallback
const CARDS_FALLBACK = [
  { id:0, name:"RamÃ­rez", img:"https://s93.erome.com/5472/K3IRZbxx/Y8DPmT76.jpeg?v=1764825894", rarity:"common", atk:60, def:50, power:"Paso Firme", attackType:"wind", unlocked: true },
  { id:1, name:"Azulita", img:"https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", rarity:"rare", atk:70, def:55, power:"Confeti Ãcido", attackType:"fire", unlocked: true },
  { id:2, name:"Tormenta", img:"https://s93.erome.com/5472/K3IRZbxx/7GmdJa3U.jpeg?v=1764802552", rarity:"epic", atk:80, def:45, power:"Torbellino", attackType:"wind", unlocked: true },
  { id:3, name:"Fortaleza", img:"https://s93.erome.com/5472/K3IRZbxx/1FvcJ5u7.png?v=1764809177", rarity:"rare", atk:60, def:70, power:"Muralla", attackType:"ice", unlocked: true },
  { id:4, name:"Danza", img:"https://s93.erome.com/5472/K3IRZbxx/0VxSvgAl.jpeg?v=1764818017", rarity:"epic", atk:75, def:50, power:"Baile Ã‰pico", attackType:"wind", unlocked: true },
  { id:5, name:"Furia", img:"https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", rarity:"legendary", atk:90, def:40, power:"Ira Incontenible", attackType:"fire", unlocked: true },
  { id:6, name:"Escudera", img:"https://s93.erome.com/5472/K3IRZbxx/9RweIpam.jpeg?v=1764813677", rarity:"common", atk:55, def:65, power:"ProtecciÃ³n", attackType:"ice", unlocked: true },
  { id:7, name:"Asesina", img:"https://s206.erome.com/4699/lpRzYjBO/Z5Tc5k2v.jpeg?v=1745795818", rarity:"legendary", atk:95, def:30, power:"Golpe Letal", attackType:"fire", unlocked: true },
  { id:8, name:"Guardiana", img:"https://s206.erome.com/4699/lpRzYjBO/P9p2wv5y.jpeg?v=1745795818", rarity:"epic", atk:50, def:80, power:"Escudo EnergÃ©tico", attackType:"ice", unlocked: true },
  { id:9, name:"IA Ã‰LITE", img:"https://s206.erome.com/4699/lpRzYjBO/gU2HfmRY.jpeg?v=1745795818", rarity:"legendary", atk:100, def:35, power:"Tirano", attackType:"arcane", unlocked: true },
  { id:10, name:"Sellamara Gemelas", img:"https://s326.erome.com/5139/YBnb1NTO/R8jmYVqr.jpeg?v=1750357395", rarity:"legendary", atk:120, def:60, power:"DesafÃ­o Final", attackType:"arcane", unlocked: false }
];

// Cartas especiales para la IA con mÃ¡s vida
const IA_CARDS = [
  { id:101, name:"IA RamÃ­rez", img:"https://s93.erome.com/5472/K3IRZbxx/Y8DPmT76.jpeg?v=1764825894", rarity:"common", atk:60, def:80, power:"Paso Firme Mejorado", attackType:"wind", unlocked: true },
  { id:102, name:"IA Azulita", img:"https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", rarity:"rare", atk:70, def:85, power:"Confeti Ãcido Doble", attackType:"fire", unlocked: true },
  { id:103, name:"IA Tormenta", img:"https://s93.erome.com/5472/K3IRZbxx/7GmdJa3U.jpeg?v=1764802552", rarity:"epic", atk:80, def:75, power:"Torbellino Destructor", attackType:"wind", unlocked: true },
  { id:104, name:"IA Fortaleza", img:"https://s93.erome.com/5472/K3IRZbxx/1FvcJ5u7.png?v=1764809177", rarity:"rare", atk:60, def:100, power:"Muralla Imbatible", attackType:"ice", unlocked: true },
  { id:105, name:"IA Danza", img:"https://s93.erome.com/5472/K3IRZbxx/0VxSvgAl.jpeg?v=1764818017", rarity:"epic", atk:75, def:80, power:"Baile Mortal", attackType:"wind", unlocked: true },
  { id:106, name:"IA Furia", img:"https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", rarity:"legendary", atk:90, def:70, power:"Ira Absoluta", attackType:"fire", unlocked: true },
  { id:107, name:"IA Escudera", img:"https://s93.erome.com/5472/K3IRZbxx/9RweIpam.jpeg?v=1764813677", rarity:"common", atk:55, def:95, power:"ProtecciÃ³n Total", attackType:"ice", unlocked: true },
  { id:108, name:"IA Asesina", img:"https://s206.erome.com/4699/lpRzYjBO/Z5Tc5k2v.jpeg?v=1745795818", rarity:"legendary", atk:95, def:60, power:"Golpe Aniquilador", attackType:"fire", unlocked: true },
  { id:109, name:"IA Guardiana", img:"https://s206.erome.com/4699/lpRzYjBO/P9p2wv5y.jpeg?v=1745795818", rarity:"epic", atk:50, def:110, power:"Escudo Divino", attackType:"ice", unlocked: true },
  { id:110, name:"IA Ã‰LITE", img:"https://s206.erome.com/4699/lpRzYjBO/gU2HfmRY.jpeg?v=1745795818", rarity:"legendary", atk:100, def:65, power:"Tirano Supremo", attackType:"arcane", unlocked: true }
];

const FortniteGame: React.FC = () => {
  const {
    player,
    currentDeck,
    playerCards,
    enemyCard,
    gameActive,
    playerTurn,
    selectedPlayerCard,
    currentView,
    battleLog,
    cards,
    LEAGUES,
    setCurrentView,
    startBattle,
    attackWithSelected,
    exitBattle,
    addToDeck,
    removeFromDeck,
    saveDeck,
    buyItem,
    updateRanking,
    saveCollection,
    setSelectedPlayerCard,
    setBattleLog
  } = useFortniteGame();

  const [ranking, setRanking] = useState<any[]>([]);
  const [selectedCard, setSelectedCard] = useState<Card | null>(null);
  const [storeMessage, setStoreMessage] = useState<string>('');
  const [particles, setParticles] = useState<JSX.Element[]>([]);
  const [battleEffect, setBattleEffect] = useState<string | null>(null);
  const [backgroundPosition, setBackgroundPosition] = useState({ x: 0, y: 0 });

  // Crear partÃ­culas de fondo
  useEffect(() => {
    const createParticles = () => {
      const newParticles = [];
      const colors = ['rgba(255,107,107,0.7)', 'rgba(78,205,196,0.7)', 'rgba(254,202,87,0.7)'];
      
      for (let i = 0; i < 15; i++) {
        const size = Math.random() * 4 + 1;
        const left = Math.random() * 100;
        const top = Math.random() * 100;
        const color = colors[Math.floor(Math.random() * colors.length)];
        const duration = 15 + Math.random() * 20;
        const tx = (Math.random() - 0.5) * 200;
        const ty = (Math.random() - 0.5) * 200;
        
        newParticles.push(
          <div
            key={i}
            className="particle absolute rounded-full"
            style={{
              width: `${size}px`,
              height: `${size}px`,
              left: `${left}%`,
              top: `${top}%`,
              background: color,
              animation: `float ${duration}s infinite linear`,
              '--tx': `${tx}px`,
              '--ty': `${ty}px`,
            } as React.CSSProperties}
          />
        );
      }
      
      setParticles(newParticles);
    };

    createParticles();
  }, []);

  // Efecto de fondo animado
  useEffect(() => {
    const handleMouseMove = (e: MouseEvent) => {
      const x = (e.clientX / window.innerWidth) * 100;
      const y = (e.clientY / window.innerHeight) * 100;
      setBackgroundPosition({ x, y });
    };

    window.addEventListener('mousemove', handleMouseMove);
    return () => window.removeEventListener('mousemove', handleMouseMove);
  }, []);

  // Efectos de batalla
  useEffect(() => {
    if (battleEffect) {
      const timer = setTimeout(() => setBattleEffect(null), 1000);
      return () => clearTimeout(timer);
    }
  }, [battleEffect]);

  // Actualizar ranking
  useEffect(() => {
    setRanking(updateRanking());
  }, [player.trophies]);

  // Temporizador de actualizaciÃ³n
  const [updateTime, setUpdateTime] = useState<string>('');
  useEffect(() => {
    const updateTimer = () => {
      const now = new Date();
      const target = new Date(now);
      target.setHours(15, 0, 0, 0);
      if (now >= target) {
        target.setDate(target.getDate() + 1);
      }
      const diff = target - now;
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      setUpdateTime(`${hours}h ${minutes}m`);
    };

    updateTimer();
    const interval = setInterval(updateTimer, 60000);
    return () => clearInterval(interval);
  }, []);

  const handleBuyItem = (itemId: string, cost: number) => {
    if (buyItem(itemId, cost)) {
      setStoreMessage('Â¡Compra exitosa! ğŸ‰');
      setTimeout(() => setStoreMessage(''), 3000);
    } else {
      setStoreMessage('âŒ Diamantes insuficientes.');
      setTimeout(() => setStoreMessage(''), 3000);
    }
  };

  const showCardPreview = (card: Card) => {
    setSelectedCard(card);
  };

  const closeCardPreview = () => {
    setSelectedCard(null);
  };

  const getRarityClass = (rarity: string) => {
    switch (rarity) {
      case 'common': return 'common';
      case 'rare': return 'rare';
      case 'epic': return 'epic';
      case 'legendary': return 'legendary';
      default: return 'common';
    }
  };

  const getRarityColor = (rarity: string) => {
    switch (rarity) {
      case 'common': return 'text-white';
      case 'rare': return 'text-orange-500';
      case 'epic': return 'text-purple-400';
      case 'legendary': return 'text-transparent bg-clip-text bg-gradient-to-r from-red-500 via-yellow-500 to-blue-500';
      default: return 'text-white';
    }
  };

  const getStoreItemClass = (type: string) => {
    switch (type) {
      case 'gold': return 'border-l-yellow-500';
      case 'purple': return 'border-l-purple-400';
      case 'orange': return 'border-l-orange-500';
      default: return 'border-l-gray-500';
    }
  };

  return (
    <div className="min-h-screen relative overflow-hidden" style={{
      background: `radial-gradient(circle at ${backgroundPosition.x}% ${backgroundPosition.y}%, #1a1a3e 0%, #0a0a1a 50%, #000 100%)`
    }}>
      {/* PartÃ­culas de fondo */}
      <div className="fixed inset-0 pointer-events-none z-0">
        {particles}
      </div>

      {/* Estilos CSS personalizados */}
      <style jsx>{`
        @keyframes float {
          to {
            transform: translate(var(--tx), var(--ty)) rotate(360deg);
            opacity: 0;
          }
        }
        .league-bronze { background: linear-gradient(to right, #cd7f32, #b8860b); }
        .league-silver { background: linear-gradient(to right, silver, #c0c0c0); color: #333; }
        .league-gold { background: linear-gradient(to right, gold, #daa520); }
        .league-elite { background: linear-gradient(to right, #4b0082, #8a2be2); }
        .league-legend { background: linear-gradient(45deg, red, gold, blue); animation: rainbow 3s linear infinite; }
        @keyframes rainbow { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
        .battle-table {
          background: rgba(5, 5, 15, 0.9);
          border: 3px solid gold;
          box-shadow: 0 0 30px rgba(255,215,0,0.5);
        }
        .battle-table::after {
          content: '';
          position: absolute;
          top: 0; left: 0; width: 100%; height: 100%;
          background: radial-gradient(circle, transparent 60%, rgba(0,0,0,0.7) 100%);
          pointer-events: none;
        }
      `}</style>

      <div className="relative z-10 container mx-auto px-4 py-8">
        <div className="flex justify-center mb-8">
          <img 
            src="/fortnite-logo.png" 
            alt="Fortnite Skin Battle Logo" 
            className="w-64 h-auto"
          />
        </div>

        {/* Barra de jugador */}
        <div className="bg-gray-800 bg-opacity-70 p-4 rounded-xl mb-6 flex justify-between items-center border-2 border-yellow-500">
          <div className="flex items-center gap-2">
            <span>ğŸ‘¤</span>
            <span className="font-bold">{player.name}</span>
          </div>
          <div className={`px-4 py-1 rounded-full font-bold text-sm ${player.league.badgeClass}`}>
            {player.league.name}
          </div>
          <div className="flex items-center gap-2">
            <span>ğŸ†</span>
            <span className="font-bold">{player.trophies}</span>
          </div>
          <div className="flex items-center gap-2">
            <span>ğŸ’</span>
            <span className="font-bold">{player.diamonds}</span>
          </div>
        </div>

        {/* NavegaciÃ³n */}
        <div className="flex justify-center gap-2 mb-8 flex-wrap">
          {(['battle', 'collection', 'store', 'ranking', 'tournament'] as GameView[]).map((view) => (
            <Button
              key={view}
              variant={currentView === view ? 'default' : 'outline'}
              onClick={() => setCurrentView(view)}
              className={`px-4 py-2 rounded-full font-bold transition-all ${
                currentView === view 
                  ? 'bg-cyan-500 text-gray-900' 
                  : 'bg-cyan-500 bg-opacity-20 text-white border-cyan-500 hover:bg-cyan-500 hover:text-gray-900'
              }`}
            >
              {view === 'battle' && 'âš”ï¸ Batalla'}
              {view === 'collection' && 'ğŸƒ Mazo'}
              {view === 'store' && 'ğŸ›’ Tienda'}
              {view === 'ranking' && 'ğŸ“Š Ranking'}
              {view === 'tournament' && 'ğŸ† Torneo'}
            </Button>
          ))}
        </div>

        {/* Vista de Batalla */}
        {currentView === 'battle' && !gameActive && (
          <div className="text-center">
            <Button 
              onClick={startBattle}
              className="bg-red-500 hover:bg-red-600 text-white font-bold text-xl px-8 py-4 rounded-full mb-4 transform transition hover:scale-105"
            >
              âš”ï¸ Â¡INICIAR BATALLA CONTRA LA IA!
            </Button>
            <p className="text-cyan-400">Usa las cartas de tu mazo para derrotar a la IA.</p>
          </div>
        )}

        {/* Mesa de Batalla */}
        {gameActive && (
          <div className="battle-table rounded-2xl p-6 mb-8 relative max-w-4xl mx-auto">
            <div className="battle-header text-cyan-400 text-xl font-bold mb-6 text-center">
              BATALLA CONTRA LA IA - Arena: {player.league.name}
            </div>

            <div className="flex justify-between items-center mb-8">
              {/* Zona del Enemigo */}
              <div className="text-center w-5/12">
                <div className="zone-title text-red-500 font-bold mb-4">IA</div>
                {enemyCard && (
                  <div className="relative">
                    <img 
                      src={enemyCard.img} 
                      alt="IA" 
                      className="w-40 h-56 object-cover rounded-xl border-4 border-gray-700 mx-auto shadow-lg"
                    />
                    <div className={`absolute top-2 right-2 px-2 py-1 rounded text-xs font-bold bg-black bg-opacity-60 ${getRarityColor(enemyCard.rarity)}`}>
                      {enemyCard.rarity}
                    </div>
                    <div className="w-full h-3 bg-gray-700 rounded-full mt-2 overflow-hidden">
                      <div 
                        className="h-full bg-gradient-to-r from-red-500 to-orange-500 transition-all duration-500"
                        style={{ width: `${((enemyCard.currentHp || 0) / enemyCard.def) * 100}%` }}
                      />
                    </div>
                    <div className="text-yellow-400 text-sm mt-1">
                      HP: {enemyCard.currentHp || 0}
                    </div>
                  </div>
                )}
              </div>

              {/* Zona del Jugador */}
              <div className="text-center w-5/12">
                <div className="zone-title text-cyan-400 font-bold mb-4">TÃš</div>
                {selectedPlayerCard && (
                  <div className="relative">
                    <img 
                      src={selectedPlayerCard.img} 
                      alt="Jugador" 
                      className="w-40 h-56 object-cover rounded-xl border-4 border-gray-700 mx-auto shadow-lg"
                    />
                    <div className={`absolute top-2 right-2 px-2 py-1 rounded text-xs font-bold bg-black bg-opacity-60 ${getRarityColor(selectedPlayerCard.rarity)}`}>
                      {selectedPlayerCard.rarity}
                    </div>
                    <div className="w-full h-3 bg-gray-700 rounded-full mt-2 overflow-hidden">
                      <div 
                        className="h-full bg-gradient-to-r from-red-500 to-orange-500 transition-all duration-500"
                        style={{ width: `${((selectedPlayerCard.currentHp || 0) / selectedPlayerCard.def) * 100}%` }}
                      />
                    </div>
                    <div className="text-yellow-400 text-sm mt-1">
                      HP: {selectedPlayerCard.currentHp || 0}
                    </div>
                  </div>
                )}
              </div>
            </div>

            {/* Registro de Batalla */}
            <div 
              className="bg-black bg-opacity-60 p-4 rounded-xl mb-6 min-h-20 text-yellow-400 border border-cyan-400"
              dangerouslySetInnerHTML={{ __html: battleLog }}
            />

            {/* Mano del Jugador */}
            <div className="flex justify-center gap-4 mb-6 flex-wrap">
              {playerCards.map((card) => (
                card.alive && (
                  <div 
                    key={card.id}
                    className="bg-gray-800 bg-opacity-90 p-3 rounded-xl cursor-pointer transition-all hover:-translate-y-2 hover:shadow-lg hover:shadow-cyan-500/50 border-2 border-cyan-500 w-28"
                    onClick={() => {
                      setSelectedPlayerCard(card);
                      attackWithSelected();
                    }}
                  >
                    <img 
                      src={card.img} 
                      alt={card.name} 
                      className="w-full h-32 object-cover rounded-lg mb-2"
                    />
                    <div className="text-sm font-bold text-center">{card.name}</div>
                  </div>
                )
              ))}
            </div>

            <Button 
              onClick={exitBattle}
              className="bg-red-500 hover:bg-red-600"
            >
              ğŸšª Salir
            </Button>
          </div>
        )}

        {/* Vista de ColecciÃ³n/Mazo */}
        {currentView === 'collection' && (
          <div className="max-w-4xl mx-auto">
            <h2 className="text-2xl font-bold text-cyan-400 mb-4">Mi Mazo (3 cartas)</h2>
            <p className="mb-6">Selecciona cartas desbloqueadas para tu mazo. Â¡Haz clic para ver detalles!</p>
            
            <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-8">
              {CARDS_FALLBACK.map((card) => {
                const isInDeck = currentDeck.includes(card.id);
                
                return (
                  <div 
                    key={card.id}
                    className={`relative rounded-lg overflow-hidden cursor-pointer transition-all ${
                      card.id === 10 ? 'opacity-60' : 'hover:scale-105'
                    } ${isInDeck ? 'ring-2 ring-yellow-500' : ''}`}
                    onClick={() => showCardPreview(card)}
                  >
                    <img 
                      src={card.img} 
                      alt={card.name} 
                      className={`w-full h-32 object-cover ${card.id === 10 ? 'grayscale' : ''} ${card.id === 10 ? 'ring-2 ring-yellow-400' : ''}`}
                    />
                    {card.id === 10 && (
                      <div className="absolute inset-0 flex items-center justify-center bg-black bg-opacity-70 border-2 border-yellow-400">
                        <span className="text-4xl">ğŸ”’</span>
                      </div>
                    )}
                    {isInDeck && (
                      <div className="absolute top-1 right-1 bg-yellow-500 text-black text-xs px-2 py-1 rounded">
                        En mazo
                      </div>
                    )}
                    {/* Debug: mostrar ID de la carta */}
                    <div className="absolute bottom-0 left-0 bg-red-500 text-white text-xs px-1">
                      ID: {card.id}
                    </div>
                  </div>
                );
              })}
            </div>

            <CardComponent className="bg-gray-800 bg-opacity-60 border border-cyan-400">
              <CardHeader>
                <CardTitle>Tu Mazo Actual</CardTitle>
              </CardHeader>
              <CardContent>
                <div className="flex justify-center flex-wrap gap-4 mb-4">
                  {currentDeck.map((cardId) => {
                    const card = CARDS_FALLBACK.find(c => c.id === cardId);
                    if (!card) return null;
                    
                    return (
                      <div key={cardId} className="relative w-24">
                        <img 
                          src={card.img} 
                          alt={card.name} 
                          className={`w-full h-32 object-cover rounded-lg ${card.id === 10 ? 'grayscale' : ''}`}
                          onClick={() => showCardPreview(card)}
                        />
                        {card.id === 10 && (
                          <div className="text-red-500 text-xs mt-1 text-center">ğŸ”’ Bloqueada</div>
                        )}
                        <Button
                          size="sm"
                          variant="destructive"
                          className="mt-2 w-full"
                          onClick={() => removeFromDeck(cardId)}
                        >
                          Quitar
                        </Button>
                      </div>
                    );
                  })}
                </div>
                <Button onClick={saveDeck} className="w-full">
                  ğŸ’¾ Guardar Mazo
                </Button>
              </CardContent>
            </CardComponent>
          </div>
        )}

        {/* Vista de Tienda */}
        {currentView === 'store' && (
          <div className="max-w-2xl mx-auto bg-gray-800 bg-opacity-50 p-6 rounded-xl border border-red-500">
            <h3 className="text-2xl font-bold text-yellow-500 mb-6 font-bebas-neue">ğŸ›’ TIENDA DE BATALLA</h3>
            
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div className={`bg-gray-900 bg-opacity-80 p-4 rounded-lg border-l-4 ${getStoreItemClass('gold')}`}>
                <div className="font-bold">Skin Dorada</div>
                <div className="text-sm">+30 DEF</div>
                <div className="text-yellow-500 font-bold">50 ğŸ’</div>
                <Button 
                  size="sm"
                  className="mt-2 w-full"
                  onClick={() => handleBuyItem('golden_skin', 50)}
                >
                  Comprar
                </Button>
              </div>
              
              <div className={`bg-gray-900 bg-opacity-80 p-4 rounded-lg border-l-4 ${getStoreItemClass('purple')}`}>
                <div className="font-bold">Confeti Ã‰pico</div>
                <div className="text-sm">Ataque Sorpresa</div>
                <div className="text-yellow-500 font-bold">30 ğŸ’</div>
                <Button 
                  size="sm"
                  className="mt-2 w-full"
                  onClick={() => handleBuyItem('epic_confetti', 30)}
                >
                  Comprar
                </Button>
              </div>
              
              <div className={`bg-gray-900 bg-opacity-80 p-4 rounded-lg border-l-4 ${getStoreItemClass('orange')}`}>
                <div className="font-bold">Doble Voto</div>
                <div className="text-sm">Doble Ataque</div>
                <div className="text-yellow-500 font-bold">70 ğŸ’</div>
                <Button 
                  size="sm"
                  className="mt-2 w-full"
                  onClick={() => handleBuyItem('double_vote', 70)}
                >
                  Comprar
                </Button>
              </div>
            </div>
            
            {storeMessage && (
              <p className="mt-4 text-cyan-400 italic">{storeMessage}</p>
            )}
          </div>
        )}

        {/* Vista de Ranking */}
        {currentView === 'ranking' && (
          <div className="max-w-2xl mx-auto bg-gray-800 bg-opacity-60 p-6 rounded-xl border border-cyan-400">
            <h2 className="text-2xl font-bold text-cyan-400 mb-6">ğŸ“Š RANKING DE JUGADORES</h2>
            
            <div className="space-y-2">
              {ranking.map((player, index) => (
                <div 
                  key={index}
                  className={`flex justify-between items-center p-3 rounded-lg ${
                    index === 0 ? 'bg-yellow-500 bg-opacity-20 font-bold' : 'bg-gray-700 bg-opacity-30'
                  } ${index === 0 ? 'text-yellow-400' : ''}`}
                >
                  <span>{index + 1}. {player.name}</span>
                  <span>{player.trophies} ğŸ†</span>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Vista de Torneo */}
        {currentView === 'tournament' && (
          <div className="max-w-4xl mx-auto">
            <div className="bg-gradient-to-r from-purple-900 to-blue-900 bg-opacity-80 p-8 rounded-xl border-2 border-yellow-500 mb-8">
              <h2 className="text-3xl font-bold text-yellow-400 mb-6 text-center">ğŸ† TORNEO LEGENDARIO ğŸ†</h2>
              
              <div className="bg-black bg-opacity-50 p-6 rounded-lg mb-6">
                <h3 className="text-xl font-bold text-cyan-400 mb-4">PREMIO</h3>
                <div className="flex justify-center items-center gap-4">
                  <div className="text-center">
                    <div className="text-4xl mb-2">ğŸ†</div>
                    <div className="text-yellow-400 font-bold">Sellamara Gemelas</div>
                    <div className="text-sm text-gray-300">Carta Legendaria</div>
                  </div>
                </div>
              </div>

              <div className="bg-black bg-opacity-50 p-6 rounded-lg mb-6">
                <h3 className="text-xl font-bold text-cyan-400 mb-4">REQUISITOS</h3>
                <ul className="space-y-2 text-white">
                  <li className="flex items-center gap-2">
                    <span>âœ…</span>
                    <span>Alcanzar la liga ORO (400+ trofeos)</span>
                  </li>
                  <li className="flex items-center gap-2">
                    <span>âœ…</span>
                    <span>Ganar 10 batallas consecutivas</span>
                  </li>
                  <li className="flex items-center gap-2">
                    <span>âœ…</span>
                    <span>Tener al menos 5 cartas Ã©picas o legendarias en tu colecciÃ³n</span>
                  </li>
                </ul>
              </div>

              <div className="text-center">
                <Button 
                  className="bg-gradient-to-r from-yellow-500 to-orange-500 text-black font-bold text-lg px-8 py-4 rounded-full mb-4 transform transition hover:scale-105"
                  onClick={() => {
                    if (player.trophies < 400) {
                      alert('Â¡Necesitas al menos 400 trofeos para participar en el torneo!');
                    } else {
                      alert('Â¡Torneo en desarrollo! PrÃ³ximamente podrÃ¡s participar para ganar la carta legendaria.');
                    }
                  }}
                >
                  ğŸš€ PARTICIPAR EN EL TORNEO
                </Button>
                <p className="text-gray-300 text-sm">El torneo estarÃ¡ disponible prÃ³ximamente</p>
              </div>
            </div>
          </div>
        )}

        {/* PrÃ³xima ActualizaciÃ³n */}
        <div className="max-w-2xl mx-auto mt-12 bg-black bg-opacity-40 p-6 rounded-xl border-2 border-dashed border-yellow-500 text-center">
          <h3 className="text-2xl font-bold text-yellow-500 mb-2">ğŸ”” Â¡PRÃ“XIMA ACTUALIZACIÃ“N! ğŸ””</h3>
          <p className="mb-2"><strong>Hoy a las 15:00</strong></p>
          <p className="mb-4">Â¡Modo Multijugador + Perfil + Ranking!</p>
          <div className="text-cyan-400 text-xl font-bold">{updateTime}</div>
        </div>
      </div>

      {/* Vista previa de carta */}
      {selectedCard && (
        <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50" onClick={closeCardPreview}>
          <div className="bg-gray-900 p-6 rounded-xl max-w-sm w-full mx-4 border-3 border-yellow-500 shadow-2xl" onClick={(e) => e.stopPropagation()}>
            <img 
              src={selectedCard.img} 
              alt={selectedCard.name} 
              className="w-full h-64 object-cover rounded-lg mb-4"
            />
            <h3 className="text-xl font-bold mb-2">{selectedCard.name}</h3>
            <div className={`inline-block px-3 py-1 rounded-full text-sm font-bold mb-2 ${
              selectedCard.rarity === 'common' ? 'bg-gray-600 text-white' :
              selectedCard.rarity === 'rare' ? 'bg-orange-500 bg-opacity-30 text-orange-500' :
              selectedCard.rarity === 'epic' ? 'bg-purple-500 bg-opacity-30 text-purple-400' :
              'bg-gradient-to-r from-red-500 via-yellow-500 to-blue-500 text-transparent bg-clip-text'
            }`}>
              {selectedCard.rarity === 'common' && 'ComÃºn'}
              {selectedCard.rarity === 'rare' && 'Rara'}
              {selectedCard.rarity === 'epic' && 'Ã‰pica'}
              {selectedCard.rarity === 'legendary' && 'Legendaria'}
            </div>
            <div className="mb-2">ATK: {selectedCard.atk} | DEF: {selectedCard.def}</div>
            <div className="text-yellow-400 italic mb-2">{selectedCard.power}</div>
            {selectedCard.id === 10 && (
              <div className="text-yellow-400 text-sm">
                Â¡Se consigue en un desafÃ­o especial!
              </div>
            )}
            {selectedCard.unlocked && !currentDeck.includes(selectedCard.id) && currentDeck.length < 3 && (
              <Button 
                className="w-full mt-4"
                onClick={() => {
                  addToDeck(selectedCard.id);
                  closeCardPreview();
                }}
              >
                AÃ±adir al mazo
              </Button>
            )}
          </div>
        </div>
      )}
    </div>
  );
};

export default FortniteGame;
